# ============================================
# OSG 职业培训平台 - 项目配置
# ============================================

# 项目基本信息
name: "osg-platform"
type: fullstack
description: "金融行业求职培训 B2C 平台"

# 技术栈
tech_stack:
  backend:
    language: java
    runtime: "Java 21"
    framework: spring-boot
    version: "3.x"
    orm: mybatis
  frontend:
    language: typescript
    framework: vue
    version: "3.x"
    ui: ant-design-vue
    state: pinia
    package_manager: pnpm
  database:
    type: mysql
    version: "8.0"
  cache:
    type: redis

# 命令映射
commands:
  # 后端命令
  test: "mvn test"
  test-single: "mvn test -Dtest={class}"
  build: "mvn -DskipTests package"
  lint: "mvn checkstyle:check || true"
  run: "mvn -pl ruoyi-admin -am spring-boot:run"
  
  # 前端命令
  frontend:
    install: "cd osg-frontend && pnpm install"
    build: "cd osg-frontend && pnpm build"
    lint: "cd osg-frontend && pnpm lint || true"
    dev: "cd osg-frontend && pnpm dev:student"
    dev-student: "cd osg-frontend && pnpm dev:student"
    dev-mentor: "cd osg-frontend && pnpm dev:mentor"
    dev-lead-mentor: "cd osg-frontend && pnpm dev:lead-mentor"
    dev-assistant: "cd osg-frontend && pnpm dev:assistant"
    dev-admin: "cd osg-frontend && pnpm dev:admin"
  
  # 运维命令
  ops:
    docker_build: "docker-compose build"
    docker_run: "docker-compose up -d"
    logs: "docker-compose logs -f"
    health: "curl -s http://localhost:8080/actuator/health"

# 目录约定
paths:
  backend:
    source: "ruoyi-*/src/main/java/"
    tests: "ruoyi-*/src/test/java/"
    controllers: "ruoyi-admin/src/main/java/**/controller/"
    services: "ruoyi-system/src/main/java/**/service/"
    mappers: "ruoyi-system/src/main/java/**/mapper/"
  frontend:
    source: "osg-frontend/packages/"
    admin: "osg-frontend/packages/admin/"              # 管理后台（Vue 3 + Ant Design Vue）
    admin_legacy: "ruoyi-ui/"                           # 若依前端（保留做运维）
    components: "osg-frontend/packages/shared/src/components/"
    pages: "osg-frontend/packages/*/src/views/"
    api: "osg-frontend/packages/shared/src/api/"
    types: "osg-frontend/packages/shared/src/types/"
  docs:
    spec: "osg-spec-docs/docs/"
    source: "osg-spec-docs/source/"                     # PRD 源文件（需求文档原始版）
    prototypes: "osg-spec-docs/source/prototype/"       # UI 原型 HTML
    prd: "osg-spec-docs/prd/"                            # PRD 需求文档（从 HTML 原型生成）
    api: "osg-spec-docs/docs/06-api/"
    database: "osg-spec-docs/docs/07-database/"
    requirements: "osg-spec-docs/docs/02-requirements/"
  tasks:
    root: "osg-spec-docs/tasks/"
    state: "osg-spec-docs/tasks/STATE.yaml"
    stories: "osg-spec-docs/tasks/stories/"
    tickets: "osg-spec-docs/tasks/tickets/"

# 启用的开发者角色
developers:
  - backend-java
  - frontend-vue
  - frontend-admin    # 管理后台前端（UI 还原 + 功能实现）
  - dba-mysql

# 业务角色
roles:
  - student      # 学生
  - mentor       # 导师
  - lead-mentor  # 班主任
  - assistant    # 助教
  - admin        # 管理员

# 前端端口配置
ports:
  student: 3001
  mentor: 3002
  lead-mentor: 3003
  assistant: 3004
  admin: 3005          # 管理后台（osg-frontend/packages/admin）
  admin_legacy: 8080   # 若依管理后台（ruoyi-ui，保留做运维）

# 审批配置
approval:
  story_split: required      # Story 拆分后需要审批
  ticket_split: required     # Ticket 拆分后需要审批
  ticket_done: auto          # Ticket 完成后自动继续
  story_done: required       # Story 完成需要人工审批

# 自动执行限制
limits:
  max_iterations: 20         # 最大迭代次数
  max_retries: 3             # 最大重试次数
  ticket_timeout: 30         # Ticket 超时（分钟）
