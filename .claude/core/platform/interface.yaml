# ============================================
# 平台适配层接口定义
# ============================================

# 支持的平台
platforms:
  - cursor       # Cursor IDE (Prompt 模拟)
  - claude-cli   # Claude CLI (原生子代理)
  - mcp          # MCP Server (工具调用)
  - openai       # OpenAI API (Function Calling)

# 默认平台
default_platform: cursor

# 接口定义
interfaces:
  # 1. 子代理调用接口
  subagent:
    dispatch:
      description: "分派子代理执行任务"
      parameters:
        agent_name: string
        task_context: object
        prompt_template: string
      returns:
        result: object
        status: string  # success | failed | needs_review
    
    review:
      description: "子代理审查"
      parameters:
        review_type: string  # spec | quality
        implementation: object
        requirements: object
      returns:
        passed: boolean
        issues: array
  
  # 2. Hooks 触发接口
  hooks:
    session_start:
      description: "会话开始钩子"
      triggers:
        - startup
        - resume
        - clear
        - compact
      actions:
        - load_state
        - inject_framework
        - output_status
    
    session_end:
      description: "会话结束钩子"
      triggers:
        - exit
        - timeout
      actions:
        - save_checkpoint
        - compress_context
    
    ticket_complete:
      description: "Ticket 完成钩子"
      triggers:
        - ticket_done
      actions:
        - create_checkpoint
        - update_state
        - trigger_review
    
    error_occur:
      description: "错误发生钩子"
      triggers:
        - execution_error
        - test_failed
        - validation_failed
      actions:
        - log_error
        - trigger_debugging
  
  # 3. 工具调用接口
  tools:
    read_file:
      description: "读取文件"
      parameters:
        path: string
      returns:
        content: string
        exists: boolean
    
    write_file:
      description: "写入文件"
      parameters:
        path: string
        content: string
      returns:
        success: boolean
    
    run_command:
      description: "执行命令"
      parameters:
        command: string
        cwd: string
      returns:
        output: string
        exit_code: integer
    
    search_files:
      description: "搜索文件"
      parameters:
        pattern: string
        path: string
      returns:
        matches: array
